syntax = "proto3";

option csharp_namespace = "GameProtocol";

// 게이트웨이 서버
//
// 여기서 로그인/로그아웃은 클라이언트의 실행 종료 시 스폰된 객체를 지우는 용도입니다.
// 이 데모에선 세션이나 토큰을 사용한 인증을 진행하지 않습니다.
service GatewayServer {
  // 로그인
  rpc Login(LoginRequest) returns (LoginResponse);
  
  // 로그아웃
  rpc Logout(LogoutRequest) returns (LogoutResponse);
  
  // 위치 정보 송신과 월드 정보 수신을 동시에 처리하는 양방향 스트림
  rpc Connect (stream ClientConnectionRequest) returns (stream ServerConnectionResponse);
}

message LoginRequest {
  string playerId = 1;
}

message LoginResponse {
}

message LogoutRequest {
  string playerId = 1;
}

message LogoutResponse {
}

message ClientConnectionRequest {
  oneof message {
    PlayerPosition position_update = 1;
  }
}

message ServerConnectionResponse {
  oneof message {
    SubscribeResponse world_update = 1;
  }
}

message SubscribeResponse {
  repeated PlayerPosition playerPositionList = 1;
}

message PlayerPosition {
  string playerId = 1;
  double x = 2;
  double y = 3;
  double z = 4;
  double pitch = 5;
  double yaw = 6;
  double roll = 7;
}